<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Step 03 - TSA for trends &mdash; pyamr 0.0.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/logo-pyamr-icon.png"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="ASAI - Index" href="../indexes/plot_core_asai.html" />
    <link rel="prev" title="Step 02 - Time Series Analysis" href="plot_step_03.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> pyamr
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/registries.html">Registries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/todo.html">Future Actions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Galleries</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tutorial</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#guide">Guide</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_step_00.html">Step 00 - Registries</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_step_01.html">Step 01 - Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_step_02.html">Step 02 - Temporal evolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_step_03.html">Step 02 - Time Series Analysis</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Step 03 - TSA for trends</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#indexes">Indexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#metrics">Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#regression">Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#statistics">Statistics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../indexes/index.html">Examples with indexes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../forecasting/index.html">Examples with TSA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reports/index.html">Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../visualization/index.html">Visualization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../_apidoc/modules.html">pyamr</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">pyamr</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Tutorial</a> &raquo;</li>
      <li>Step 03 - TSA for trends</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/_examples/tutorial/guide/plot_step_04.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-tutorial-guide-plot-step-04-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="step-03-tsa-for-trends">
<span id="sphx-glr-examples-tutorial-guide-plot-step-04-py"></span><h1>Step 03 - TSA for trends<a class="headerlink" href="#step-03-tsa-for-trends" title="Permalink to this headline"></a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>To be completed!</p>
</div>
<p>The diagram in Figure 4.7 describes the methodology implemented to estimate secular
trends in AMR from susceptibility data. Since data corruption might occur in clinical
environments, those susceptibility test records wrongly reported (human or device errors)
or duplicated were discarded. The remaining records were divided into combinations
(tuples defined by sample type, pathogen and antimicrobial) for which a resistance time
series signal was generated using either independent or overlapping time intervals (see
xxx). The time series were linearly interpolated to fill sporadic missing values. No
additional filters or preprocessing steps were applied. An analysis of stationarity around
a trend was carried out to identify interesting combinations and regression
analysis was used to quantify its tendency</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">23</span> <span class="c1"># .. image:: ../../../_static/imgs/sart-diagram.png</span>
<span class="linenos">24</span> <span class="c1">#   :width: 600</span>
<span class="linenos">25</span> <span class="c1">#   :align: center</span>
<span class="linenos">26</span> <span class="c1">#   :alt: Diagram</span>
<span class="linenos">27</span> <span class="c1">#</span>
<span class="linenos">28</span> <span class="c1"># |</span>
<span class="linenos">29</span> <span class="c1">#</span>
<span class="linenos">30</span> <span class="c1"># The linear model (see Equation 4.3) has been selected to quantify resistance tendency</span>
<span class="linenos">31</span> <span class="c1"># for several reasons: (i) the development of resistance in pathogens is an evolutionary</span>
<span class="linenos">32</span> <span class="c1"># response to the selective pressure of antimicrobials, hence large variations in short</span>
<span class="linenos">33</span> <span class="c1"># periods (e.g. consecutive days or months) are not expected (ii) the slope parameter can</span>
<span class="linenos">34</span> <span class="c1"># be directly translated to change over time increasing its practicability and (iii) the</span>
<span class="linenos">35</span> <span class="c1"># offset parameter is highly related with the overall resistance. Hence, the response variable</span>
<span class="linenos">36</span> <span class="c1"># in regression analysis (resistance index) is described by the explanatory variable (time).</span>
<span class="linenos">37</span> <span class="c1"># The slope (m) ranges within the interval [-1,1] where sign and absolute value capture</span>
<span class="linenos">38</span> <span class="c1"># direction and rate of change respectively. The unit of the slope is represented by ∆y/∆x.</span>
<span class="linenos">39</span> <span class="c1">#</span>
<span class="linenos">40</span> <span class="c1"># - **Least Squares Regression**</span>
<span class="linenos">41</span> <span class="c1">#</span>
<span class="linenos">42</span> <span class="c1">#   The optimization problem in ordinary least squares - ``OLS`` - regression minimizes the least</span>
<span class="linenos">43</span> <span class="c1">#   square errors to find the best fitting model. Ordinary least squares - OLS - assumes</span>
<span class="linenos">44</span> <span class="c1">#   identical weights (wi) and independently distributed residuals with a normal distribution.</span>
<span class="linenos">45</span> <span class="c1">#   It is frequent to observe that some residuals might have higher variance than others,</span>
<span class="linenos">46</span> <span class="c1">#   meaning that those observations are effectively less certain. To contemplate such variability,</span>
<span class="linenos">47</span> <span class="c1">#   weighted linear squares - ``WLS`` - regression (see Equation 4.4) applies a weighting</span>
<span class="linenos">48</span> <span class="c1">#   function to the residuals. The confidence of the computed resistance index (observed</span>
<span class="linenos">49</span> <span class="c1">#   variable) relies on the number of susceptibility test records manipulated. Hence, the</span>
<span class="linenos">50</span> <span class="c1">#   sigmoid function has been used to define weights proportional to the population size.</span>
<span class="linenos">51</span> <span class="c1">#</span>
<span class="linenos">52</span> <span class="c1"># - **Auto Regressive Integrated Moving Average** - ``ARIMA``</span>
<span class="linenos">53</span> <span class="c1">#</span>
<span class="linenos">54</span> <span class="c1">#   An autoregressive integrated moving average (ARIMA) model is a generalization of an</span>
<span class="linenos">55</span> <span class="c1">#   autoregressive moving average (ARMA) model which can be also applied in scenarios</span>
<span class="linenos">56</span> <span class="c1">#   where data show evidence of non-stationarity. The autoregressive (AR) part expresses</span>
<span class="linenos">57</span> <span class="c1">#   the variable of interest (resistance index) as a function of past values of the variable.</span>
<span class="linenos">58</span> <span class="c1">#   The moving average (MA) indicates that the regression error is a linear combination of</span>
<span class="linenos">59</span> <span class="c1">#   error terms which occurred contemporaneously and at various times in the past. An</span>
<span class="linenos">60</span> <span class="c1">#   ARIMA(p,d,q) model is described by: p is the number of autoregressive terms,</span>
<span class="linenos">61</span> <span class="c1">#   d is the number of differences needed for stationarity and q is the</span>
<span class="linenos">62</span> <span class="c1">#   number of lagged forecast errors.</span>
<span class="linenos">63</span> <span class="c1">#</span>
<span class="linenos">64</span> <span class="c1">#   Include formula.</span>
<span class="linenos">65</span> <span class="c1">#</span>
<span class="linenos">66</span> <span class="c1">#   The interpretation of the parameter µ depends on the ARIMA model used for the</span>
<span class="linenos">67</span> <span class="c1">#   fitting. In order to estimate the linear trend, it was interesting to consider exclusively</span>
<span class="linenos">68</span> <span class="c1">#   MA models so that the expected value of µ was the mean of the one-time differenced</span>
<span class="linenos">69</span> <span class="c1">#   series; that is, the slope coefficient of the un-differenced series. The Bayesian information</span>
<span class="linenos">70</span> <span class="c1">#   criterion (BIC) was used to select the best ARIMA(0,1,q) model, being the one with the</span>
<span class="linenos">71</span> <span class="c1">#   lowest BIC the preferred.</span>
<span class="linenos">72</span> <span class="c1">#</span>
<span class="linenos">73</span> <span class="c1">#</span>
<span class="linenos">74</span>
<span class="linenos">75</span> <span class="c1"># Import</span>
<span class="linenos">76</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.001 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-tutorial-guide-plot-step-04-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/043e29a397954fb60ba60e44ded380bc/plot_step_04.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_step_04.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/31ac67b748492807d3fceabf652ec62a/plot_step_04.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_step_04.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plot_step_03.html" class="btn btn-neutral float-left" title="Step 02 - Time Series Analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../indexes/plot_core_asai.html" class="btn btn-neutral float-right" title="ASAI - Index" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Bernard Hernandez.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>