<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Step 04 - TSA to estimate trends &mdash; pyamr 0.0.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/logo-pyamr-icon.png"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> pyamr
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/todo.html">Future Actions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Galleries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../indexes/index.html">Examples with indexes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../forecasting/index.html">Examples with TSA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../visualization/index.html">Visualization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../_apidoc/modules.html">pyamr</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">pyamr</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Step 04 - TSA to estimate trends</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/_examples/tutorial/guide/plot_step_04.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-tutorial-guide-plot-step-04-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="step-04-tsa-to-estimate-trends">
<span id="sphx-glr-examples-tutorial-guide-plot-step-04-py"></span><h1>Step 04 - TSA to estimate trends<a class="headerlink" href="#step-04-tsa-to-estimate-trends" title="Permalink to this headline"></a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>To be completed!</p>
</div>
<p>The diagram in Figure 4.7 describes the methodology implemented to estimate secular
trends in AMR from susceptibility data. Since data corruption might occur in clinical
environments, those susceptibility test records wrongly reported (human or device errors)
or duplicated were discarded. The remaining records were divided into combinations
(tuples defined by sample type, pathogen and antimicrobial) for which a resistance time
series signal was generated using either independent or overlapping time intervals (see
xxx). The time series were linearly interpolated to fill sporadic missing values. No
additional filters or preprocessing steps were applied. An analysis of stationarity around
a trend was carried out to identify interesting combinations and regression
analysis was used to quantify its tendency</p>
<a class="reference internal image-reference" href="../../../_images/sart-diagram.png"><img alt="Diagram" class="align-center" src="../../../_images/sart-diagram.png" style="width: 600px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The linear model (see Equation 4.3) has been selected to quantify resistance tendency
for several reasons: (i) the development of resistance in pathogens is an evolutionary
response to the selective pressure of antimicrobials, hence large variations in short
periods (e.g. consecutive days or months) are not expected (ii) the slope parameter can
be directly translated to change over time increasing its practicability and (iii) the
offset parameter is highly related with the overall resistance. Hence, the response variable
in regression analysis (resistance index) is described by the explanatory variable (time).
The slope (m) ranges within the interval [-1,1] where sign and absolute value capture
direction and rate of change respectively. The unit of the slope is represented by ∆y/∆x.</p>
<ul>
<li><p><strong>Least Squares Regression</strong></p>
<p>The optimization problem in ordinary least squares - <code class="docutils literal notranslate"><span class="pre">OLS</span></code> - regression minimizes the least
square errors to find the best fitting model. Ordinary least squares - OLS - assumes
identical weights (wi) and independently distributed residuals with a normal distribution.
It is frequent to observe that some residuals might have higher variance than others,
meaning that those observations are effectively less certain. To contemplate such variability,
weighted linear squares - <code class="docutils literal notranslate"><span class="pre">WLS</span></code> - regression (see Equation 4.4) applies a weighting
function to the residuals. The confidence of the computed resistance index (observed
variable) relies on the number of susceptibility test records manipulated. Hence, the
sigmoid function has been used to define weights proportional to the population size.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Include equation.</p>
</div>
</li>
<li><p><strong>Auto Regressive Integrated Moving Average</strong> - <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code></p>
<p>An autoregressive integrated moving average (ARIMA) model is a generalization of an
autoregressive moving average (ARMA) model which can be also applied in scenarios
where data show evidence of non-stationarity. The autoregressive (AR) part expresses
the variable of interest (resistance index) as a function of past values of the variable.
The moving average (MA) indicates that the regression error is a linear combination of
error terms which occurred contemporaneously and at various times in the past. An
ARIMA(p,d,q) model is described by: p is the number of autoregressive terms,
d is the number of differences needed for stationarity and q is the
number of lagged forecast errors.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Include equation.</p>
</div>
<p>The interpretation of the parameter µ depends on the ARIMA model used for the
fitting. In order to estimate the linear trend, it was interesting to consider exclusively
MA models so that the expected value of µ was the mean of the one-time differenced
series; that is, the slope coefficient of the un-differenced series. The Bayesian information
criterion (BIC) was used to select the best ARIMA(0,1,q) model, being the one with the
lowest BIC the preferred.</p>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">77</span> <span class="c1"># Import</span>
<span class="linenos">78</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.001 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-tutorial-guide-plot-step-04-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/043e29a397954fb60ba60e44ded380bc/plot_step_04.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_step_04.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/31ac67b748492807d3fceabf652ec62a/plot_step_04.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_step_04.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2023, Bernard Hernandez.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>